# S03 – eda_cli: мини-EDA для CSV

Небольшое CLI-приложение для базового анализа CSV-файлов.
Используется в рамках Семинара 03 курса «Инженерия ИИ».

## Требования

- Python 3.11+
- [uv](https://docs.astral.sh/uv/) установлен в систему

## Инициализация проекта

В корне проекта (S03):

```bash
uv sync
```

Эта команда:

- создаст виртуальное окружение `.venv`;
- установит зависимости из `pyproject.toml`;
- установит сам проект `eda-cli` в окружение.

## Запуск CLI

### Краткий обзор

Команда `overview`:
    Краткий обзор содержимого датасета: число строк и столбцов, типы колонок, основные свойства, пропуски, уникальные значения.
    Пример использования: 

```bash
uv run eda-cli overview data/example.csv
```

Параметры:

- `--sep` – разделитель (по умолчанию `,`);
- `--encoding` – кодировка (по умолчанию `utf-8`).

### Полный EDA-отчёт

Инструмент командной строки для проведения экспресс-EDA (Exploratory Data Analysis) над CSV-файлами.
Позволяет получать обзор структуры данных, вычислять статистики, анализировать пропуски и строить визуализации.
Результатом является отчёт в формате Markdown и вспомогательные файлы.

Команда `report`:
    Формирует полный EDA-отчёт, включая сводную статистику, анализ пропусков, корреляции, гистограммы и таблицы для категориальных признаков.
        Пример использования: 

```bash
uv run eda-cli report data/S02-hw-dataset.csv --out-dir reports_dataset_HW02_new_options --max-hist-columns 2 --top-k 3 --title "Отчёт по датасету"
```

В результате в каталоге `reports/` появятся:

- `report.md` – основной отчёт в Markdown;
- `summary.csv` – таблица по колонкам;
- `missing.csv` – пропуски по колонкам;
- `correlation.csv` – корреляционная матрица (если есть числовые признаки);
- `top_categories/*.csv` – top-k категорий по строковым признакам;
- `hist_*.png` – max-hist-columns гистограмм числовых колонок;
- `missing_matrix.png` – визуализация пропусков;
- `correlation_heatmap.png` – тепловая карта корреляций.

Команда `report` поддерживает дополнительные параметры, влияющие на формирование отчёта.
- `--max-hist-columns N` - ограничивает число числовых колонок, по которым будут построены гистограммы;
- `--top-k-categories N` - указывает, сколько наиболее частых значений необходимо выводить для категориальных колонок;
- `--title TEXT` - задает заголовок, который будет размещён в начале файла report.md.


## HTTP-сервис (FastAPI)

Проект включает HTTP-сервис на базе FastAPI для оценки качества датасетов.

### Запуск сервера

```bash
uv run uvicorn eda_cli.api:app --reload --port 8000
```

Сервер будет доступен по адресу `http://localhost:8000`. Документация API доступна по адресу `http://localhost:8000/docs`.

### Эндпоинты

- `GET /health` - проверка работоспособности сервиса
- `POST /quality` - оценка качества по агрегированным признакам
- `POST /quality-from-csv` - оценка качества по CSV-файлу
- `POST /quality-flags-from-csv` - полный набор флагов качества по CSV-файлу (включая расширенные эвристики из HW03)

## Клиент для тестирования API

В проекте есть клиентский скрипт для тестирования API сервиса.

### Запуск клиента

```bash
uv run uvicorn eda_cli.api:app --port 8000
```
```bash
uv run python scripts/client.py
```

Клиент выполняет:
- Тестирование эндпоинта `/quality` с разными параметрами
- Тестирование эндпоинта `/quality-from-csv` с CSV-файлами из папки `data/`
- Тестирование эндпоинта `/quality-flags-from-csv` с CSV-файлами
- Выводит сводку по всем запросам (статус, `quality_score`, `latency_ms`)

## Тесты

```bash
uv run pytest -q
```
